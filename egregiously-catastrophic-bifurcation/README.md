# Egregiously Catastropic Bifurcation - Solution overview

Start by connecting to the server:

	$ nc 104.131.107.153 12734

I sit there for a while and nothing happens, so I start typing in random stuff to see what happens:

	asdfsadfsad
	39e5e5055f969e50b54db452ca1e8c3c28802144980a179bf618e53c4be4047c3e89e7a61bb639aa3fca4dc9a89d3e32fe3480540b37fdd71b25818bc02aa18ac342258c55e4a647f9500ee0d692b610f8d3d131baec40e448096bf23d5c62d1155208be78008bc14e134a190595b2b7cedf134b1f913b6d3e9c9ccfe46d232f62b20cb110a528a729d5012b9d7627b386a2c28061193a326aa7fe639aedec6b
	dfsafdafd
	39e5e5055f969e50b54db452ca1e8c3c28802144980a179bf618e53c4be4047c3e89e7a61bb639aa3fca4dc9a89d3e32fe3480540b37fdd71b25818bc02aa18ac342258c55e4a647f9500ee0d692b610f8d3d131baec40e448096bf23d5c62d1155208be78008bc14e134a190595b2b787aef9d20f4540cb437b833c943a8c8c1e3fbfb8842aa7a39811b063e4a30292
	adsfsaffsafd
	39e5e5055f969e50b54db452ca1e8c3c28802144980a179bf618e53c4be4047c3e89e7a61bb639aa3fca4dc9a89d3e32fe3480540b37fdd71b25818bc02aa18ac342258c55e4a647f9500ee0d692b610f8d3d131baec40e448096bf23d5c62d1155208be78008bc14e134a190595b2b7e0ef15ce983bc0cb3d6eb1ebf3522442c79f30ca7b6129bfabda792d7780e5a0ddb4ace93f4a05bf23b3c393979fa793

The output only seems to contain hexadecimal digits, so I'll bet this is some kind of hex-encoded data. However, if we try decoding it, it comes out unreadable:

	$ python
	Python 2.7.6 (default, Mar 22 2014, 22:59:56)
	[GCC 4.8.2] on linux2
	Type "help", "copyright", "credits" or "license" for more information.
	>>> "39e5e5055f969e50b54db452ca1e8c3c28802144980a179bf618e53c4be4047c3e89e7a61bb639aa3fca4dc9a89d3e32fe3480540b37fdd71b25818bc02aa18ac342258c55e4a647f9500ee0d692b610f8d3d131baec40e448096bf23d5c62d1155208be78008bc14e134a190595b2b7e0ef15ce983bc0cb3d6eb1ebf3522442c79f30ca7b6129bfabda792d7780e5a0ddb4ace93f4a05bf23b3c393979fa793".decode('hex')
	'9\xe5\xe5\x05_\x96\x9eP\xb5M\xb4R\xca\x1e\x8c<(\x80!D\x98\n\x17\x9b\xf6\x18\xe5<K\xe4\x04|>\x89\xe7\xa6\x1b\xb69\xaa?\xcaM\xc9\xa8\x9d>2\xfe4\x80T\x0b7\xfd\xd7\x1b%\x81\x8b\xc0*\xa1\x8a\xc3B%\x8cU\xe4\xa6G\xf9P\x0e\xe0\xd6\x92\xb6\x10\xf8\xd3\xd11\xba\xec@\xe4H\tk\xf2=\\b\xd1\x15R\x08\xbex\x00\x8b\xc1N\x13J\x19\x05\x95\xb2\xb7\xe0\xef\x15\xce\x98;\xc0\xcb=n\xb1\xeb\xf3R$B\xc7\x9f0\xca{a)\xbf\xab\xday-w\x80\xe5\xa0\xdd\xb4\xac\xe9?J\x05\xbf#\xb3\xc3\x93\x97\x9f\xa7\x93'

Also, it looks like it's giving output that has some repetition. This string is coming up at the beginning of the server's response each time we send something:

	39e5e5055f969e50b54db452ca1e8c3c28802144980a179bf618e53c4be4047c3e89e7a61bb639aa3fca4dc9a89d3e32fe3480540b37fdd71b25818bc02aa18ac342258c55e4a647f9500ee0d692b610f8d3d131baec40e448096bf23d5c62d1155208be78008bc14e134a190595b2b7

Let's try connecting again and just sending random stuff again:

	$ nc 104.131.107.153 12734
	asdf
	9aed6e484e9b94a5be1088f44c1490cf15975cdb5de88916c727e5433a39e6dff9e19b68ef8c05a087468cbd571952d3508dd6a883af55dcc7cbc86cf87f4fd2d6ccb74718b36d9d3003003bdce0b7adf412a8384338b05a6e603f4084fa64eaae2cbf0e2a06e1705478d48002406564
	asdf
	9aed6e484e9b94a5be1088f44c1490cf15975cdb5de88916c727e5433a39e6dff9e19b68ef8c05a087468cbd571952d3508dd6a883af55dcc7cbc86cf87f4fd2d6ccb74718b36d9d3003003bdce0b7adf412a8384338b05a6e603f4084fa64eaae2cbf0e2a06e1705478d48002406564
	asdfasdf
	9aed6e484e9b94a5be1088f44c1490cf15975cdb5de88916c727e5433a39e6dff9e19b68ef8c05a087468cbd571952d3508dd6a883af55dcc7cbc86cf87f4fd2d6ccb74718b36d9d3003003bdce0b7adb869cb6386612be67aeb24b9183357faded9b741e7b7cf1ee05bdc0e3b887fce
	asdfsadfasdfsadf
	9aed6e484e9b94a5be1088f44c1490cf15975cdb5de88916c727e5433a39e6dff9e19b68ef8c05a087468cbd571952d3508dd6a883af55dcc7cbc86cf87f4fd2d6ccb74718b36d9d3003003bdce0b7ad04cba1d2a579c5f9417dcff9086c4bbbf08b78beb0a6edfb12c3e5693ed679727b3440cac7a475d2c31e501baecf7cac
	asdfasdfsadfasdfasdfasdfasdfasdf
	9aed6e484e9b94a5be1088f44c1490cf15975cdb5de88916c727e5433a39e6dff9e19b68ef8c05a087468cbd571952d3508dd6a883af55dcc7cbc86cf87f4fd2d6ccb74718b36d9d3003003bdce0b7ad186405ba68ab18ce0cd801d57e0053563305e8f610f0bf757e632ee2eaa90471f08b78beb0a6edfb12c3e5693ed679727b3440cac7a475d2c31e501baecf7cac
	asdfasdfasdf
	9aed6e484e9b94a5be1088f44c1490cf15975cdb5de88916c727e5433a39e6dff9e19b68ef8c05a087468cbd571952d3508dd6a883af55dcc7cbc86cf87f4fd2d6ccb74718b36d9d3003003bdce0b7ad0ccee755e6d05b2f524555af00eebf6e28e574294397d02582e83157f3e4c65e
	asdfsadfsadfsadfasdfsadf
	9aed6e484e9b94a5be1088f44c1490cf15975cdb5de88916c727e5433a39e6dff9e19b68ef8c05a087468cbd571952d3508dd6a883af55dcc7cbc86cf87f4fd2d6ccb74718b36d9d3003003bdce0b7adeb8466c3c7d445966201401640aff39ef138f9781358b53cca4220962494ad0fded9b741e7b7cf1ee05bdc0e3b887fce

Okay, so we got more hex output back from the server this time, so that's consistent with what we saw before. This time, every message starts with the same prefix, but the prefix seems to be different from the last time we connected. Also, there's something interesting going on with the lengths of the server's responses:

* For the inputs `asdf` (4 characters), `asdfasdf` (8 characters), and `asdfasdfasdf` (12 characters), the server's response was the same length each time.

* However, `asdfsadfasdfsadf` (16 characters) and `asdfsadfsadfsadfasdfsadf` (24 characters) produced longer responses.

* Finally, `asdfasdfsadfasdfasdfasdfasdfasdf` (32 characters) produced a response that was longer than any of the rest.

If we look at the lengths of the responses, we can see that they're all 16 bytes apart (i.e. 32 hex digits). This seems to indicate that they might be using some kind of block cipher, with a 16-byte block size.

Let's try more random inputs and see what happens:

	$ nc 104.131.107.153 12734
	AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
	c4d9a04a3b6d54ae02aacaf4fd8ad9f18740295e16edb8a39c204d861641f1a7bc902cd6ece74e00d43fd0b586d0e9d087b15199c6331f400070cc6bcb40990b5b4851e0b41ec1452e98e2ed1139f1d8b6e5d6ae1500817b9008a3b0259f8231efaa036273ce77a1b13b716e652e1aa726cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f79d4856489e3daf55321c35f11eafed097a0b3af3f4c3c7f0690fdc3ddef5efb
	AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
	c4d9a04a3b6d54ae02aacaf4fd8ad9f18740295e16edb8a39c204d861641f1a7bc902cd6ece74e00d43fd0b586d0e9d087b15199c6331f400070cc6bcb40990b5b4851e0b41ec1452e98e2ed1139f1d8b6e5d6ae1500817b9008a3b0259f8231efaa036273ce77a1b13b716e652e1aa726cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1f26cc6addb7acb8890706dee1ddaa1c1fe818dc85391ef39b3edc29be4fb6d0c4f7c99b09476ae7ce60b789abd73d3716

This time we just spammed `A`s for our inputs. If you look carefully at the responses, there's a repeating pattern. The string `26cc6addb7acb8890706dee1ddaa1c1f` is basically spammed throughout the server response, just like the `A`s we spammed in the input. If you're having trouble seeing it due to the horizontal scroll bar, it might be helpful to search for this string in your web browser in order to highlight it and see just how many places it shows up.

In addition, this repeating string just so happens to be 16 bytes long. At this point it's pretty safe to draw two conclusions:

* Since the lengths of the outputs are all multiples of 16 bytes, this challenge is very likely encrypting the inputs using some kind of block cipher with a block size of 16 bytes.

* In addition, since there's so much repetition in the ciphertext, and the repeating pattern is itself 16 bytes long, the block cipher is apparently being used in [electronic codebook](http://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Electronic_Codebook_.28ECB.29) mode.

[Electronic codebook mode, or ECB](http://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Electronic_Codebook_.28ECB.29), is a block cipher mode that leaves distinct patterns in the ciphertext that can give away a large amount of information about the corresponding plaintext. Because ECB leaks information about the plaintext, it should not be considered secure in any way, and should never be used in practice. See the pictures of the Linux penguin in the [Wikipedia article on block cipher modes](http://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Electronic_Codebook_.28ECB.29) for a good example of the kind of information that ECB-encrypted ciphertexts can leak about the plaintext.

Another thing we can see in this output from the server is that there's a sequence of blocks at the end that's different from the repeating pattern. The first output ends with `79d4856489e3daf55321c35f11eafed097a0b3af3f4c3c7f0690fdc3ddef5efb` after the repeating pattern, and the second output ends with `e818dc85391ef39b3edc29be4fb6d0c4f7c99b09476ae7ce60b789abd73d3716` after the repeating pattern.

Since we know that our input of `A`s is causing a repeating pattern of ciphertext blocks `26cc6addb7acb8890706dee1ddaa1c1f`, then when the ciphertext blocks change to something else, that probably indicates that some other data is being encrypted along with our data as well.

Since block ciphers can only encrypt messages whose lengths are multiples of the block size, we know that the server must be applying some form of [padding](http://en.wikipedia.org/wiki/Padding_%28cryptography%29#Block_cipher_mode_of_operation) in order to accommodate messages of all possible lengths.

However, the use of padding usually will only cause at most a single block to be different from the repeating pattern. For example, if the plaintext consists of 3 blocks of all `A`s followed by only a single `A`, then the resulting ciphertext for ECB mode would consist of 3 repeated ciphertext blocks followed by a single different ciphertext block.

In this case, though, we're getting a full two blocks of different ciphertext after the repeating pattern. This suggests that the server may be appending something to our input before padding it and then encrypting it.

In order to test this, I'll try sending messages of varying lengths and seeing what happens. I'm using Python to produce increasing numbers of `A`s to use as input to the server. Here's what it looks like:

	$ python -c "for i in xrange(50): print 'A'*i"
	
	A
	AA
	AAA
	AAAA
	AAAAA
	AAAAAA
	AAAAAAA
	AAAAAAAA
	AAAAAAAAA
	AAAAAAAAAA
	AAAAAAAAAAA
	AAAAAAAAAAAA
	AAAAAAAAAAAAA
	[...]

Now let's try it on the actual server:

	$ python -c "for i in xrange(50): print 'A'*i" | nc 104.131.107.153 12734
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba7ead275ab196a90c2ac4c3d74dd5d28129811d06544b3579e671d3029b70b0e4
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba23e0bc095f517ac79aeae402e8f04e2c1945409d527c421fc8d25dcdcc80d8c5
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba6169b21a27cf50665b75bc2c6881040f3c1980462c41dccd8f9bd654e17609d1
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba41382057359f0356cf7eee471e118a42f3499f1d2746cecd74be81f215cdc55f
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba298264eeadb62d3acf66e11e9260c02e787e9d6662d3c65d92a77ab20bb70a3d
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5bac6876bd09adb9ef1717ce094cf33c6c41d15500c0181446c98e033787f173628
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba74d23df0a48ec4fb85d50e2d82b93e5cf6eb82e9ead7e3b021c8286ea10d7eb6
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5babdd7dd00cc8f4a88577fad12bd27fc7e0b1ec213d93d7add40ad56feaccde134
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba9f6b7935625b2d3fe7512b43b6f318fb21b887a50e6dd0d278bc4da2cf7f990b
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba6a6e825b9cad4d7a560428fb61d557ac799882f89ec6472fa3001d25513d2f82
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba1448bf3d05a2e9db8cc97a2addb93e3734229ec871eead6ed08d2c318aeabe46
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba694fd46fee026661b6f60d2364a20383debf9597c792ff5e7635f540116d593493d8d558a87b961aa2d0f7203cd06b99
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5bae66f8b68bc3fb6b3cb355692c3e98c5c3ebbe63b99894ed7d760e96c1ee76ce0db5a37b4ddde454b6aaa67780ba08774
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba08d8c3d8ae11020cbcb16456d390efd1639b1da81b78802337fbfbc4c96c11306793933822d48880883f124c60076a85
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6ac674f78fa75f3f1a0f3dbd3efd4d31cde4957ae2f26d99400e008a3a0ac4ab482
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6acd078567ec49ec11c7a39bc9d2dad4b11fbf57eee3f1c1b3a4e1353ad633696dc
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6acabd61cc3d19f400a628f3df52212bc8829811d06544b3579e671d3029b70b0e4
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6acae107f0b3547c8278a5526370ed066201945409d527c421fc8d25dcdcc80d8c5
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6ace7e5f852dba87457e4427728a40527483c1980462c41dccd8f9bd654e17609d1
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6ac9c4fb171eb08f4843a9063ec50ea70c2f3499f1d2746cecd74be81f215cdc55f
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6aca359a9ada9514a1e45b1b1c612f60db1787e9d6662d3c65d92a77ab20bb70a3d
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6ac3a058ed132087b4b754515f0484fd47f1d15500c0181446c98e033787f173628
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6ac4167332c8f3b42b3ab92151efee4f555f6eb82e9ead7e3b021c8286ea10d7eb6
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6ac143e84031b3740550ab4a7b3cdf3ca710b1ec213d93d7add40ad56feaccde134
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6aca0dd52a39547e20ced01e85c7e6b3aa521b887a50e6dd0d278bc4da2cf7f990b
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6ac5b24405d66cb04f26e9ca08b71a5ed16799882f89ec6472fa3001d25513d2f82
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6acac39ce903f16cb28d53621b6b31f1c2834229ec871eead6ed08d2c318aeabe46
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6acd572f41fab356a8c151677744c04b866debf9597c792ff5e7635f540116d593493d8d558a87b961aa2d0f7203cd06b99
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6ac39ada1d7af5d6db09a98dea55c9322913ebbe63b99894ed7d760e96c1ee76ce0db5a37b4ddde454b6aaa67780ba08774
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6acfeda2b3e01470a44288d04c5c07cd34d639b1da81b78802337fbfbc4c96c11306793933822d48880883f124c60076a85
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6aced729da50ee61c0d6971b7260013509a674f78fa75f3f1a0f3dbd3efd4d31cde4957ae2f26d99400e008a3a0ac4ab482
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6aced729da50ee61c0d6971b7260013509ad078567ec49ec11c7a39bc9d2dad4b11fbf57eee3f1c1b3a4e1353ad633696dc
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6aced729da50ee61c0d6971b7260013509aabd61cc3d19f400a628f3df52212bc8829811d06544b3579e671d3029b70b0e4
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6aced729da50ee61c0d6971b7260013509aae107f0b3547c8278a5526370ed066201945409d527c421fc8d25dcdcc80d8c5
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6aced729da50ee61c0d6971b7260013509ae7e5f852dba87457e4427728a40527483c1980462c41dccd8f9bd654e17609d1
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6aced729da50ee61c0d6971b7260013509a9c4fb171eb08f4843a9063ec50ea70c2f3499f1d2746cecd74be81f215cdc55f
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6aced729da50ee61c0d6971b7260013509aa359a9ada9514a1e45b1b1c612f60db1787e9d6662d3c65d92a77ab20bb70a3d
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6aced729da50ee61c0d6971b7260013509a3a058ed132087b4b754515f0484fd47f1d15500c0181446c98e033787f173628
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6aced729da50ee61c0d6971b7260013509a4167332c8f3b42b3ab92151efee4f555f6eb82e9ead7e3b021c8286ea10d7eb6
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6aced729da50ee61c0d6971b7260013509a143e84031b3740550ab4a7b3cdf3ca710b1ec213d93d7add40ad56feaccde134
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6aced729da50ee61c0d6971b7260013509aa0dd52a39547e20ced01e85c7e6b3aa521b887a50e6dd0d278bc4da2cf7f990b
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6aced729da50ee61c0d6971b7260013509a5b24405d66cb04f26e9ca08b71a5ed16799882f89ec6472fa3001d25513d2f82
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6aced729da50ee61c0d6971b7260013509aac39ce903f16cb28d53621b6b31f1c2834229ec871eead6ed08d2c318aeabe46
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6aced729da50ee61c0d6971b7260013509ad572f41fab356a8c151677744c04b866debf9597c792ff5e7635f540116d593493d8d558a87b961aa2d0f7203cd06b99
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6aced729da50ee61c0d6971b7260013509a39ada1d7af5d6db09a98dea55c9322913ebbe63b99894ed7d760e96c1ee76ce0db5a37b4ddde454b6aaa67780ba08774
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6aced729da50ee61c0d6971b7260013509afeda2b3e01470a44288d04c5c07cd34d639b1da81b78802337fbfbc4c96c11306793933822d48880883f124c60076a85
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6aced729da50ee61c0d6971b7260013509aed729da50ee61c0d6971b7260013509a674f78fa75f3f1a0f3dbd3efd4d31cde4957ae2f26d99400e008a3a0ac4ab482
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6aced729da50ee61c0d6971b7260013509aed729da50ee61c0d6971b7260013509ad078567ec49ec11c7a39bc9d2dad4b11fbf57eee3f1c1b3a4e1353ad633696dc
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6aced729da50ee61c0d6971b7260013509aed729da50ee61c0d6971b7260013509aabd61cc3d19f400a628f3df52212bc8829811d06544b3579e671d3029b70b0e4
	0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba21f7165a455475cf9ae2ebe13dcff6aced729da50ee61c0d6971b7260013509aed729da50ee61c0d6971b7260013509aae107f0b3547c8278a5526370ed066201945409d527c421fc8d25dcdcc80d8c5

Okay, here's what we know from this set of ciphertexts:

* The prefix is `0799ff861f204924f5d651bbdd24cb20b28c9cd8a262398fd6e46ee7b31fe1a91dc36abfa3dc93c96a1e1cde36b6299650fcb9b19f02293d94f9e91e7550ca6edc70ac4c66743620c0efa8dcf1c403915a2922b2bb76126ab58f289307c9b5ba` for every ciphertext.

* Every 16 messages, the length of the ciphertext increases by 16 bytes, so that confirms that the server is using a block size of 16 bytes.

That's all that's really jumping out at me here. I'm not seeing any repetition in these ciphertexts other the prefix shared by each one. Let's try giving it longer inputs so that we're guaranteed some amount of repetition:

	$ python -c "for i in xrange(80, 100): print 'A'*i" | nc 104.131.107.153 12734
	685d041fd6585af7de04b665b76bbc56c4910c0eb5a9e30862aefe8737473696274315b71169f648af6122031b3d56d8122d9871a37b224df337b537a6ec2295406f25173d242c196b46ab684c11fa45ddc026e295c0720e8b391541cd2b66c6481a6459b623914b8ac4e80fab2d658d7312ea8e0711e3c8285e031cf2ec755afebaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb018857255f1e04c040b9c0488912ef5dbb3bcd19ec4e62e7efcc2fe1686cb7ce69d12
	685d041fd6585af7de04b665b76bbc56c4910c0eb5a9e30862aefe8737473696274315b71169f648af6122031b3d56d8122d9871a37b224df337b537a6ec2295406f25173d242c196b46ab684c11fa45ddc026e295c0720e8b391541cd2b66c6481a6459b623914b8ac4e80fab2d658d7312ea8e0711e3c8285e031cf2ec755afebaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885fb8c15f01d2eb006a7d828f6a21ae38af588926185fa600e08a22d86dad307dd
	685d041fd6585af7de04b665b76bbc56c4910c0eb5a9e30862aefe8737473696274315b71169f648af6122031b3d56d8122d9871a37b224df337b537a6ec2295406f25173d242c196b46ab684c11fa45ddc026e295c0720e8b391541cd2b66c6481a6459b623914b8ac4e80fab2d658d7312ea8e0711e3c8285e031cf2ec755afebaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb018858fb0e3fbaff5fc6f49794574829318344a71548f3d004693c4b1395ab453ab76
	685d041fd6585af7de04b665b76bbc56c4910c0eb5a9e30862aefe8737473696274315b71169f648af6122031b3d56d8122d9871a37b224df337b537a6ec2295406f25173d242c196b46ab684c11fa45ddc026e295c0720e8b391541cd2b66c6481a6459b623914b8ac4e80fab2d658d7312ea8e0711e3c8285e031cf2ec755afebaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb0188529c640b9170ba016461f4b3b525196d9501c87f44c0d9c2b3bf3122d173221a7
	685d041fd6585af7de04b665b76bbc56c4910c0eb5a9e30862aefe8737473696274315b71169f648af6122031b3d56d8122d9871a37b224df337b537a6ec2295406f25173d242c196b46ab684c11fa45ddc026e295c0720e8b391541cd2b66c6481a6459b623914b8ac4e80fab2d658d7312ea8e0711e3c8285e031cf2ec755afebaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb018859f6890c522329674414f7e5a84f5120b34a58595d6ddc961c26f4bd4ec46f2cd
	685d041fd6585af7de04b665b76bbc56c4910c0eb5a9e30862aefe8737473696274315b71169f648af6122031b3d56d8122d9871a37b224df337b537a6ec2295406f25173d242c196b46ab684c11fa45ddc026e295c0720e8b391541cd2b66c6481a6459b623914b8ac4e80fab2d658d7312ea8e0711e3c8285e031cf2ec755afebaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb018852271e6e46247e1385527843af1c6fe38445979f1bb72a0bcec6c1f18e97f9a6d
	685d041fd6585af7de04b665b76bbc56c4910c0eb5a9e30862aefe8737473696274315b71169f648af6122031b3d56d8122d9871a37b224df337b537a6ec2295406f25173d242c196b46ab684c11fa45ddc026e295c0720e8b391541cd2b66c6481a6459b623914b8ac4e80fab2d658d7312ea8e0711e3c8285e031cf2ec755afebaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885eac9cf8d2a9cd70b5eb8bef0863eff967c1fde8a4e5e210509aac90cb2b641eb
	685d041fd6585af7de04b665b76bbc56c4910c0eb5a9e30862aefe8737473696274315b71169f648af6122031b3d56d8122d9871a37b224df337b537a6ec2295406f25173d242c196b46ab684c11fa45ddc026e295c0720e8b391541cd2b66c6481a6459b623914b8ac4e80fab2d658d7312ea8e0711e3c8285e031cf2ec755afebaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb0188534f238ba9e73eb9215768e77536c2a5a2922371c00510a7d4f4745fb6aa47d9f
	685d041fd6585af7de04b665b76bbc56c4910c0eb5a9e30862aefe8737473696274315b71169f648af6122031b3d56d8122d9871a37b224df337b537a6ec2295406f25173d242c196b46ab684c11fa45ddc026e295c0720e8b391541cd2b66c6481a6459b623914b8ac4e80fab2d658d7312ea8e0711e3c8285e031cf2ec755afebaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb018859eaa8fa73309c5c3936c88f23c546fafaf2aaaaf319d9782a71cec283eaacbe8
	685d041fd6585af7de04b665b76bbc56c4910c0eb5a9e30862aefe8737473696274315b71169f648af6122031b3d56d8122d9871a37b224df337b537a6ec2295406f25173d242c196b46ab684c11fa45ddc026e295c0720e8b391541cd2b66c6481a6459b623914b8ac4e80fab2d658d7312ea8e0711e3c8285e031cf2ec755afebaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb0188599db32c588f2ba5ad2f97337016b2412ededadbbca546c848be1f50c20764fc00baa7eadf542711cdbd6d843d597d2f1
	685d041fd6585af7de04b665b76bbc56c4910c0eb5a9e30862aefe8737473696274315b71169f648af6122031b3d56d8122d9871a37b224df337b537a6ec2295406f25173d242c196b46ab684c11fa45ddc026e295c0720e8b391541cd2b66c6481a6459b623914b8ac4e80fab2d658d7312ea8e0711e3c8285e031cf2ec755afebaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb018859d41a0d8eb353752b182dd60cce6a26fcd4410a9385d8b9fcdf29e481d0af18743f66b3f70bd0abdd82c3f130fc4e87f
	685d041fd6585af7de04b665b76bbc56c4910c0eb5a9e30862aefe8737473696274315b71169f648af6122031b3d56d8122d9871a37b224df337b537a6ec2295406f25173d242c196b46ab684c11fa45ddc026e295c0720e8b391541cd2b66c6481a6459b623914b8ac4e80fab2d658d7312ea8e0711e3c8285e031cf2ec755afebaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb018855a101a213015d5a4e2f8ab70aa57b5e1dd31c50110f041b6b08919d63de9c496a9b678fa8f777ae0e74d4024e0d6f685
	685d041fd6585af7de04b665b76bbc56c4910c0eb5a9e30862aefe8737473696274315b71169f648af6122031b3d56d8122d9871a37b224df337b537a6ec2295406f25173d242c196b46ab684c11fa45ddc026e295c0720e8b391541cd2b66c6481a6459b623914b8ac4e80fab2d658d7312ea8e0711e3c8285e031cf2ec755afebaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb0188534ec8af65180fa61de9b5fef9ca3649a07ed5d0d9491174212f687bba7cd5567
	685d041fd6585af7de04b665b76bbc56c4910c0eb5a9e30862aefe8737473696274315b71169f648af6122031b3d56d8122d9871a37b224df337b537a6ec2295406f25173d242c196b46ab684c11fa45ddc026e295c0720e8b391541cd2b66c6481a6459b623914b8ac4e80fab2d658d7312ea8e0711e3c8285e031cf2ec755afebaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885d26c28ac81d6b598e0714a861e5fcfeccaec301e9998af15bbd5f9bb4aefd70e
	685d041fd6585af7de04b665b76bbc56c4910c0eb5a9e30862aefe8737473696274315b71169f648af6122031b3d56d8122d9871a37b224df337b537a6ec2295406f25173d242c196b46ab684c11fa45ddc026e295c0720e8b391541cd2b66c6481a6459b623914b8ac4e80fab2d658d7312ea8e0711e3c8285e031cf2ec755afebaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb018852934649a669fff7b3a749a441f2b846ab74ea4940b4eb0c85f4cfbeaf5e75d40
	685d041fd6585af7de04b665b76bbc56c4910c0eb5a9e30862aefe8737473696274315b71169f648af6122031b3d56d8122d9871a37b224df337b537a6ec2295406f25173d242c196b46ab684c11fa45ddc026e295c0720e8b391541cd2b66c6481a6459b623914b8ac4e80fab2d658d7312ea8e0711e3c8285e031cf2ec755afebaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb0188540e33fb5c43fe71d0732691ee55471bcdd277b04be9dd0cde75770be53e16461
	685d041fd6585af7de04b665b76bbc56c4910c0eb5a9e30862aefe8737473696274315b71169f648af6122031b3d56d8122d9871a37b224df337b537a6ec2295406f25173d242c196b46ab684c11fa45ddc026e295c0720e8b391541cd2b66c6481a6459b623914b8ac4e80fab2d658d7312ea8e0711e3c8285e031cf2ec755afebaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb018857255f1e04c040b9c0488912ef5dbb3bcd19ec4e62e7efcc2fe1686cb7ce69d12
	685d041fd6585af7de04b665b76bbc56c4910c0eb5a9e30862aefe8737473696274315b71169f648af6122031b3d56d8122d9871a37b224df337b537a6ec2295406f25173d242c196b46ab684c11fa45ddc026e295c0720e8b391541cd2b66c6481a6459b623914b8ac4e80fab2d658d7312ea8e0711e3c8285e031cf2ec755afebaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885fb8c15f01d2eb006a7d828f6a21ae38af588926185fa600e08a22d86dad307dd
	685d041fd6585af7de04b665b76bbc56c4910c0eb5a9e30862aefe8737473696274315b71169f648af6122031b3d56d8122d9871a37b224df337b537a6ec2295406f25173d242c196b46ab684c11fa45ddc026e295c0720e8b391541cd2b66c6481a6459b623914b8ac4e80fab2d658d7312ea8e0711e3c8285e031cf2ec755afebaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb018858fb0e3fbaff5fc6f49794574829318344a71548f3d004693c4b1395ab453ab76
	685d041fd6585af7de04b665b76bbc56c4910c0eb5a9e30862aefe8737473696274315b71169f648af6122031b3d56d8122d9871a37b224df337b537a6ec2295406f25173d242c196b46ab684c11fa45ddc026e295c0720e8b391541cd2b66c6481a6459b623914b8ac4e80fab2d658d7312ea8e0711e3c8285e031cf2ec755afebaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb01885febaf5d40f7b1914715f9c516eb0188529c640b9170ba016461f4b3b525196d9501c87f44c0d9c2b3bf3122d173221a7

Okay, that's better. From these ciphertexts, I can see a couple patterns:

* The random prefix for these ciphertexts seems to be `1914715f9c516eb01885febaf5d40f7b1914715f9c516eb018857255f1e04c040b9c0488912ef5dbb3bcd19ec4e62e7efcc2fe1686cb7ce69d12685d041fd6585af7de04b665b76bbc56c4910c0eb5a9e30862aefe8737473696274315b71169f648af6122031b3d56d8122d9871a37b224df337b537a`.

* This time, we gave enough repeated input that we were able to get repeating blocks of `5febaf5d40f7b1914715f9c516eb0188`.

* In addition, there are some patterns in the two ciphertext blocks that come after the repeating pattern:

 * No matter what, the ciphertext always ends with two different ciphertext blocks after the repeating pattern. Like we said before, the use of padding should add at most one extra ciphertext block, so this pretty much confirms that something's being added onto the end of our input before the padding and encryption.

 * The final two ciphertext blocks actually seem to be repeated in some cases. For example, two different inputs seemed to end with the ciphertext `b2d658d7312ea8e0711e3c8285e031cf2ec755afebaf5d40f7b1914715f9c516e`. As before, this might be difficult to see because of the horizontal scroll bars. It will probably be helpful if you hit `Ctrl-F` in your browser and search for the string.

Since those final two ciphertext blocks seem to be repeated for certain inputs, we can theorize that not only is the server appending some suffix to our input before each encryption, it's probably appending the *same* suffix to our input before each encryption.

As it turns out, there is an attack on ECB for cases where the input to the encryption operation is `[random data] + [user input] + [suffix]`. This attack lets you decrypt the entire `[suffix]` section of the plaintext by submitting many different values for the `[user input]` section. For this challenge, the `[suffix]` turns out to be the flag: `flag{I_s33_p3NGu1ns}`

This challenge is heavily derived from both the [Matasano Crypto Challenges](http://cryptopals.com/sets/2/challenges/12/) and the [Web Interception](http://ehsandev.com/pico2014/cryptography/web_interception.html) challenge from [PicoCTF 2014](https://www.picoctf.com/). Both of these links provide good explanations about how the attack works conceptually, especially the [Web Interception writeup](http://ehsandev.com/pico2014/cryptography/web_interception.html).

So that you can see the solution in action, I've included the service script `ecb-service.py` along with a solution script, `ecb-solution.py`. You should be able to run `ecb-service.py` locally and then modify `ecb-solution.py` to point at your local instance of the service. You can watch the solution script "decrypt" the flag character by character while watching what the requests look like on the server side.

Note that `ecb-service.py` requires the PyCrypto library, which you can install by running `pip install pycrypto`. If you run into any problems with the service or solution scripts, feel free to send me a message on IRC (nick "gaffe" on freenode).

The flag for this challenge was `flag{I_s33_p3NGu1ns}`, which was intended to be a reference to the Linux penguin images used by the [Wikipedia article on block cipher modes](http://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Electronic_Codebook_.28ECB.29) to explain the insecurity of ECB mode. I also intended for the name of the challenge to be somewhat of a hint: "Egregiously Catastrophic Bifurcation" can be abbreviated as ECB, the same abbreviation that's used for "Electronic CodeBook" mode.
